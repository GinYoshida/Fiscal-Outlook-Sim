Reactでの再構築を「バイブコーディング（指示だけで一気に組ませる）」で完結させるための、**最高レベルに詳細な実装依頼用マークダウン**を作成しました。

このままCursor、Replit、あるいはClaude 3.5 Sonnetなどに貼り付けてください。特に、今回議論した**「経常収支による金利跳ね上がり」**や**「日銀の逆ザヤの直接反映」**をロジックの核に据えています。

---

# 依頼：統合政府・家計・外部環境を網羅した30年財政シミュレーターの実装

## 1. 開発の背景と目的

2026年から2055年までの日本の財政・経済・家計への影響を予測する、高度なインタラクティブ・シミュレーターをReactで構築します。
「政府の帳簿」だけではなく、**「日銀の連結収支」「外部環境（円安・貿易）」「家計の格差（貧困・ジニ係数）」**の3つのレイヤーが相互に影響し合う動的なモデルを実装してください。

## 2. 実装すべきコア・ロジック

### A. 外部環境と「防衛ライン」 (External & Trade)

* **為替レート**: ユーザー設定の「円安進行率」で推移。
* **貿易・経常収支**:
* 輸入額は「円安による価格上昇」を反映。
* **対外純資産 (Net Foreign Assets)**:  で更新。


* **金利の動的変動 (The Trigger)**:
* もし **経常収支が赤字** かつ **対外純資産が一定以下** になった場合、市場金利に「通貨信任リスクプレミアム」として自動で **+2.0%** を加算する。



### B. 統合政府PLと日銀の逆ザヤ (Consolidated Gov & BOJ)

* **日銀収支 (BOJ Net Income)**: `(国債利息収入) - (当座預金付利コスト)`
* 納付金を `max(0, income)` でクリップせず、**負の値（逆ザヤ）もそのまま「歳入の減少」として統合政府の収支に反映**すること。


* **平均クーポン (Interest Lag)**: 全国債を9年で借り換える `(avg * 8/9 + market * 1/9)` のロジックを厳守。

### C. 家計へのインパクト (Household & Inequality)

* **実質賃金**: `名目賃金伸び率 - (インフレ率 + 円安による輸入インフレ係数)`。
* **貧困率**: インフレが賃金上昇を上回るほど、指数関数的に上昇するモデル。
* **ジニ係数**: `(資産収益率 - 実質賃金伸び率)` の差分をベースに、円安で資産家が潤い、労働者が困窮する格差拡大を可視化。

## 3. コンポーネントとUI構成

### 1. State / Logic (`useFiscalSimulation.ts`)

* 30年分のデータを `Array.map` で1年ずつ生成する関数を実装。
* 各年度の計算は、**「外部環境（為替・経常） → 政府・日銀収支 → 家計指標」**の順で行うこと。

### 2. UI Layout

* **Sidebar**: ユーザー操作用スライダー
* 基本設定: インフレ率、実質成長率、円安進行率、消費税率。


* **Dashboard (Main)**: `recharts` を使用
* **Chart 1 (Fiscal)**: 債務残高 vs 利払い負担率。
* **Chart 2 (Social)**: 実質賃金推移 vs 貧困率。
* **Chart 3 (Balance)**: 経常収支 vs 対外純資産（防衛ラインの可視化）。


* **Summary Panel**:
* 「政策予算が利払いに飲み込まれる年」
* 「経常収支が赤字転落する年」
* 「日銀が債務超過（累積赤字）になる年」を警告表示。



## 4. コーディングへの具体的指示

1. **TypeScript** を使用し、各年度のデータ型 (`FiscalYearData`) を厳密に定義してください。
2. **Tailwind CSS** と **lucide-react** を使い、モダンでシビアな（プロフェッショナルな）デザインにしてください。
3. **Responsive**: スマホで閲覧・操作することを前提に、モバイルフレンドリーなUIにしてください（サイドバーの開閉、スクロール可能なテーブル等）。
4. **Visibility**: 各列の計算根拠をツールチップ等で確認できるようにしてください。

---

### このプロンプトを投げた後の確認ポイント

AIがコードを生成したら、以下の**「最悪シナリオ」**が正しくシミュレートされているかチェックしてください。

1. **円安を加速させた時**:
* 政府の法人税や資産評価額は増えるが、**家計の「貧困率」が急上昇し、「実質賃金」がマイナス**に突っ込むか？


2. **金利を上げた時**:
* 日銀の収支がマイナスになり、それが**政府の財政赤字を直接押し上げているか？**


3. **経常収支が赤字になった時**:
* **金利が非連続的に（スパイクするように）跳ね上がる**挙動を示すか？



これらが実装されていれば、それは単なる計算機ではなく、日本の未来を構造的に理解するための「真のシミュレーター」になります。

次は、完成したシミュレーターの数値をどう読み解き、**「どの補填手段が最もマシか」**という最終結論のページ構成を考えましょうか？